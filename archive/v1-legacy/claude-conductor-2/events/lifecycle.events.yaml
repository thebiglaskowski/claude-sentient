events:
  # Session Events
  - name: session.started
    description: A new session has begun
    payload:
      type: object
      properties:
        sessionId:
          type: string
          format: uuid
        startedAt:
          type: string
          format: date-time
        task:
          type: string
        flags:
          type: object
      required: [sessionId, startedAt]
    emitters: [orchestrator]
    subscribers: [context-manager, metrics-logger, state-manager]

  - name: session.ended
    description: Session has completed
    payload:
      type: object
      properties:
        sessionId:
          type: string
          format: uuid
        endedAt:
          type: string
          format: date-time
        status:
          type: string
          enum: [complete, failed, cancelled]
        metrics:
          type: object
      required: [sessionId, endedAt, status]
    emitters: [orchestrator]
    subscribers: [metrics-logger, changelog-automation]

  # Loop Events
  - name: loop.iteration.start
    description: A new loop iteration is beginning
    payload:
      type: object
      properties:
        iteration:
          type: integer
        phase:
          type: string
        timestamp:
          type: string
          format: date-time
      required: [iteration]
    emitters: [orchestrator]
    subscribers: [budget-monitor, checkpoint, metrics-logger]

  - name: loop.iteration.complete
    description: Loop iteration has finished
    payload:
      type: object
      properties:
        iteration:
          type: integer
        duration:
          type: integer
        gatesPassed:
          type: integer
        gatesFailed:
          type: integer
      required: [iteration]
    emitters: [orchestrator]
    subscribers: [metrics-logger, state-manager]

  - name: loop.complete
    description: Loop has finished successfully
    payload:
      type: object
      properties:
        iterations:
          type: integer
        duration:
          type: integer
        metrics:
          type: object
      required: [iterations]
    emitters: [orchestrator]
    subscribers: [changelog-automation, session-end]

  # Phase Events
  - name: loop.phase.start
    description: A phase is beginning execution
    payload:
      type: object
      properties:
        phase:
          type: string
        iteration:
          type: integer
        timestamp:
          type: string
          format: date-time
      required: [phase, iteration]
    emitters: [orchestrator]
    subscribers: [metrics-logger]

  - name: loop.phase.complete
    description: A phase has finished execution
    payload:
      type: object
      properties:
        phase:
          type: string
        iteration:
          type: integer
        duration:
          type: integer
        result:
          type: object
      required: [phase, iteration]
    emitters: [orchestrator]
    subscribers: [metrics-logger, decision-logger]

  - name: loop.phase.skipped
    description: A phase was skipped
    payload:
      type: object
      properties:
        phase:
          type: string
        reason:
          type: string
      required: [phase, reason]
    emitters: [orchestrator]
    subscribers: [metrics-logger]

  - name: loop.phase.error
    description: A phase encountered an error
    payload:
      type: object
      properties:
        phase:
          type: string
        error:
          type: string
        stack:
          type: string
        recoverable:
          type: boolean
      required: [phase, error]
    emitters: [orchestrator]
    subscribers: [error-classifier, recovery, metrics-logger]

  # Classification Events
  - name: loop.task.classified
    description: Task classification complete
    payload:
      type: object
      properties:
        type:
          type: string
          enum: [depth-first, breadth-first, straightforward]
        complexity:
          type: string
          enum: [simple, medium, complex]
        subagentCount:
          type: integer
        orchestrationMode:
          type: string
          enum: [standard, swarm, pipeline]
      required: [type, complexity, orchestrationMode]
    emitters: [phase-classify]
    subscribers: [context-manager, agent-coordinator, metrics-logger]
